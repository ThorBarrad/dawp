(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2c37b5fc"],{"060f":function(e,t,r){"use strict";r("d733")},2017:function(e,t,r){"use strict";r("cafe")},"9ed6":function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"login-container"},[r("el-form",{ref:"loginForm",staticClass:"login-form",attrs:{model:e.loginForm,rules:e.loginRules,"auto-complete":"on","label-position":"left"}},[r("div",{staticClass:"title-container"},[r("h3",{staticClass:"title"},[e._v("Login Form")])]),r("el-form-item",{attrs:{prop:"username"}},[r("span",{staticClass:"svg-container"},[r("svg-icon",{attrs:{"icon-class":"user"}})],1),r("el-input",{ref:"username",attrs:{placeholder:"Username/Email",name:"username",type:"text",tabindex:"1","auto-complete":"on"},model:{value:e.loginForm.username,callback:function(t){e.$set(e.loginForm,"username",t)},expression:"loginForm.username"}})],1),r("el-form-item",{attrs:{prop:"password"}},[r("span",{staticClass:"svg-container"},[r("svg-icon",{attrs:{"icon-class":"password"}})],1),r("el-input",{key:e.passwordType,ref:"password",staticStyle:{width:"75%"},attrs:{type:e.passwordType,placeholder:"Password",name:"password",tabindex:"2","auto-complete":"on"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleLogin(t)}},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}}),r("span",{staticClass:"show-pwd",on:{click:e.showPwd}},[r("svg-icon",{attrs:{"icon-class":"password"===e.passwordType?"eye":"eye-open"}})],1)],1),r("el-form-item",{attrs:{prop:"captcha"}},[r("span",{staticClass:"svg-container"},[r("svg-icon",{attrs:{"icon-class":"form"}})],1),r("el-input",{ref:"captcha",staticStyle:{width:"67%"},attrs:{placeholder:"captcha",name:"captcha",type:"text",tabindex:"3","auto-complete":"off"},model:{value:e.loginForm.captcha,callback:function(t){e.$set(e.loginForm,"captcha",t)},expression:"loginForm.captcha"}}),r("span",{on:{click:e.renewCaptcha}},[r("el-image",{staticClass:"captchabox",attrs:{id:"captcha",src:e.prefix.image+this.captcha_name}})],1)],1),r("el-button",{staticStyle:{width:"100%","margin-bottom":"30px"},attrs:{loading:e.loading,type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.handleLogin(t)}}},[e._v("Login")]),r("el-button",{staticStyle:{width:"100%","margin-bottom":"30px"},attrs:{loading:e.loading,type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.openRegister(t)}}},[e._v("No Account? Register One!")])],1),r("el-dialog",{attrs:{title:"用户注册",visible:e.registerForm.visible,center:""},on:{"update:visible":function(t){return e.$set(e.registerForm,"visible",t)}}},[r("el-form",{ref:"registerForm",attrs:{size:"mini",model:e.registerForm,rules:e.registerRules,"auto-complete":"on","label-position":"left"}},[r("el-form-item",{attrs:{prop:"username"}},[r("span",{staticClass:"svg-container"},[r("svg-icon",{attrs:{"icon-class":"user"}})],1),r("el-input",{ref:"username",attrs:{placeholder:"Username",name:"username",type:"text",tabindex:"1","auto-complete":"on"},model:{value:e.registerForm.username,callback:function(t){e.$set(e.registerForm,"username",t)},expression:"registerForm.username"}})],1),r("el-form-item",{attrs:{prop:"password"}},[r("span",{staticClass:"svg-container"},[r("svg-icon",{attrs:{"icon-class":"password"}})],1),r("el-input",{key:e.passwordType2,ref:"password",attrs:{type:e.passwordType2,placeholder:"Password",name:"password",tabindex:"2","auto-complete":"on"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleRegister(t)}},model:{value:e.registerForm.password,callback:function(t){e.$set(e.registerForm,"password",t)},expression:"registerForm.password"}}),r("span",{staticClass:"show-pwd",on:{click:e.showPwd2}},[r("svg-icon",{attrs:{"icon-class":"password"===e.passwordType2?"eye":"eye-open"}})],1)],1),r("el-form-item",{attrs:{prop:"password"}},[r("span",{staticClass:"svg-container"},[r("svg-icon",{attrs:{"icon-class":"password"}})],1),r("el-input",{key:e.passwordType3,ref:"password",attrs:{type:e.passwordType3,placeholder:"Cofirm Password",name:"password",tabindex:"2","auto-complete":"on"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleRegister(t)}},model:{value:e.registerForm.confirmpassword,callback:function(t){e.$set(e.registerForm,"confirmpassword",t)},expression:"registerForm.confirmpassword"}}),r("span",{staticClass:"show-pwd",on:{click:e.showPwd3}},[r("svg-icon",{attrs:{"icon-class":"password"===e.passwordType3?"eye":"eye-open"}})],1)],1),r("el-form-item",{attrs:{prop:"email"}},[r("span",{staticClass:"svg-container"},[r("svg-icon",{attrs:{"icon-class":"form"}})],1),r("el-input",{ref:"email",staticStyle:{width:"70%"},attrs:{placeholder:"email",name:"email",type:"text",tabindex:"3","auto-complete":"off"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleRegister(t)}},model:{value:e.registerForm.email,callback:function(t){e.$set(e.registerForm,"email",t)},expression:"registerForm.email"}}),r("el-button",{staticClass:"setwidth2",attrs:{type:"primary",disabled:e.loading2},nativeOn:{click:function(t){return t.preventDefault(),e.postemail(t)}}},[e._v("获取验证码")])],1),r("el-form-item",{attrs:{prop:"verifycode"}},[r("span",{staticClass:"svg-container"},[r("svg-icon",{attrs:{"icon-class":"form"}})],1),r("el-input",{ref:"verifycode",attrs:{placeholder:"verifycode",name:"verifycode",type:"text",tabindex:"3","auto-complete":"off"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleRegister(t)}},model:{value:e.registerForm.verifycode,callback:function(t){e.$set(e.registerForm,"verifycode",t)},expression:"registerForm.verifycode"}})],1),r("el-form-item",{attrs:{prop:"captcha"}},[r("span",{staticClass:"svg-container"},[r("svg-icon",{attrs:{"icon-class":"form"}})],1),r("el-input",{ref:"captcha",staticStyle:{width:"67%"},attrs:{placeholder:"captcha",name:"captcha",type:"text",tabindex:"3","auto-complete":"off"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleRegister(t)}},model:{value:e.registerForm.captcha,callback:function(t){e.$set(e.registerForm,"captcha",t)},expression:"registerForm.captcha"}}),r("span",{on:{click:e.renewCaptcha}},[r("el-image",{staticClass:"captchabox2",attrs:{id:"captcha",src:e.prefix.image+this.captcha_name}})],1)],1),r("el-button",{staticStyle:{width:"100%","margin-bottom":"30px"},attrs:{loading:e.loading,type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.handleRegister(t)}}},[e._v("Register")])],1)],1)],1)},a=[],o=r("61f7"),n=r("4ec3"),i=r("5f87"),c=r("5c96"),p={name:"Login",created:function(){},data:function(){var e=function(e,t,r){t?r():r(new Error("请输入用户名或邮箱"))},t=function(e,t,r){Object(o["e"])(t)?r():r(new Error("密码需要包含数字和大小写字母，6-12位"))},r=function(e,t,r){Object(o["f"])(t)?r():r(new Error("用户名需要以英文字母开头，6-16位"))},s=function(e,t,r){Object(o["b"])(t)?r():r(new Error("验证码4位不区分大小写"))},a=function(e,t,r){Object(o["c"])(t)?r():r(new Error("邮件名称错误"))},n=function(e,t,r){Object(o["d"])(t)?r():r(new Error("邮件验证码6位，区分大小写，请从邮件复制"))};return{prefix:{image:"https://sjh.mcl913.top:20001/"},loginForm:{username:"",password:"",captcha:"",visible:!1},registerForm:{username:"",password:"",captcha:"",email:"",verifycode:"",visible:!1,confirmpassword:""},loginRules:{username:[{required:!0,trigger:"blur",validator:e}],password:[{required:!0,trigger:"blur",validator:t}],captcha:[{required:!0,trigger:"blur",validator:s}]},registerRules:{username:[{required:!0,trigger:"blur",validator:r}],password:[{required:!0,trigger:"blur",validator:t}],confirmpassword:[{required:!0,trigger:"blur",validator:t}],captcha:[{required:!0,trigger:"blur",validator:s}],email:[{required:!0,trigger:"blur",validator:a}],verifycode:[{required:!0,trigger:"blur",validator:n}]},loading:!1,loading2:!1,passwordType:"password",passwordType2:"password",passwordType3:"password",redirect:void 0,captcha_name:""}},watch:{$route:{handler:function(e){var t=this;Object(n["e"])().then((function(e){sessionStorage.setItem("publicKey",e.pubkey),sessionStorage.setItem("csrf_token",e.csrf_token);var r=Math.random(),s=new FormData;s.append("id",r),s.append("pubkey",sessionStorage.getItem("publicKey")),Object(n["d"])(s).then((function(e){t.captcha_name=e.captcha_name}))}),(function(e){})),this.redirect=e.query&&e.query.redirect},immediate:!0}},methods:{openRegister:function(){this.registerForm.visible=!0},renewCaptcha:function(){var e=this,t=Math.random(),r=new FormData;r.append("id",t),r.append("pubkey",sessionStorage.getItem("publicKey")),Object(n["d"])(r).then((function(t){e.captcha_name=t.captcha_name}))},showPwd:function(){var e=this;"password"===this.passwordType?this.passwordType="":this.passwordType="password",this.$nextTick((function(){e.$refs.password.focus()}))},showPwd2:function(){var e=this;"password"===this.passwordType2?this.passwordType2="":this.passwordType2="password",this.$nextTick((function(){e.$refs.password.focus()}))},showPwd3:function(){var e=this;"password"===this.passwordType3?this.passwordType3="":this.passwordType3="password",this.$nextTick((function(){e.$refs.password.focus()}))},postemail:function(){var e=this;""!=this.registerForm.email?(this.loading2=!0,Object(n["g"])({email:this.registerForm.email}).then((function(t){c["Message"].success("验证码已发送至:"+e.registerForm.email)})),setTimeout((function(){e.loading2=!1}),6e4)):c["Message"].error("请填写邮箱")},handleLogin:function(){var e=this;""!=this.loginForm.username?""!=this.loginForm.password?""!=this.loginForm.captcha?this.$refs.loginForm.validate((function(t){if(!t)return!1;var r={username:e.loginForm.username,password:e.loginForm.password,captcha:e.loginForm.captcha,pubkey:sessionStorage.getItem("publicKey"),csrf_token:sessionStorage.getItem("csrf_token")};e.loading=!0,Object(n["a"])(r).then((function(t){return"User not exists"==t?(c["Message"].warning("用户不存在"),void(e.loading=!1)):"user and password not match"==t?(c["Message"].warning("密码错误"),void(e.loading=!1)):"CAPTCHA is not correct"==t?(c["Message"].warning("验证码错误"),e.renewCaptcha(),void(e.loading=!1)):"CSRF Token expired"==t?(c["Message"].warning("操作时间过长"),e.loading=!1,void Object(n["e"])().then((function(t){sessionStorage.setItem("publicKey",t.pubkey),sessionStorage.setItem("csrf_token",t.csrf_token);var r=Math.random(),s=new FormData;s.append("id",r),s.append("pubkey",sessionStorage.getItem("publicKey")),Object(n["d"])(s).then((function(t){e.captcha_name=t.captcha_name}))}),(function(e){}))):(Object(i["c"])(t.access_token),e.$router.push({path:"/main"}),void(e.loading=!1))})).catch((function(){e.loading=!1}))})):c["Message"].error("请填写验证码"):c["Message"].error("请填写登录密码"):c["Message"].error("请填写用户名和邮箱")},handleRegister:function(){var e=this;""!=this.registerForm.username?""!=this.registerForm.password?""!=this.registerForm.captcha?this.registerForm.password==this.registerForm.confirmpassword?this.$refs.registerForm.validate((function(t){t&&Object(n["n"])({email:e.registerForm.email,emailcode:e.registerForm.verifycode}).then((function(t){if("ok"==t){var r={username:e.registerForm.username,password:e.registerForm.password,captcha:e.registerForm.captcha,pubkey:sessionStorage.getItem("publicKey"),csrf_token:sessionStorage.getItem("csrf_token"),email:e.registerForm.email};e.loading=!0,Object(n["c"])(r).then((function(t){return"User exists"==t?(c["Message"].warning("用户已存在"),void(e.loading=!1)):"CSRF Token expired"==t?(c["Message"].warning("操作时间过长"),e.loading=!1,void Object(n["e"])().then((function(t){sessionStorage.setItem("publicKey",t.pubkey),sessionStorage.setItem("csrf_token",t.csrf_token);var r=Math.random(),s=new FormData;s.append("id",r),s.append("pubkey",sessionStorage.getItem("publicKey")),Object(n["d"])(s).then((function(t){e.captcha_name=t.captcha_name}))}),(function(e){}))):"CAPTCHA is not correct"==t?(c["Message"].warning("验证码错误"),e.renewCaptcha(),void(e.loading=!1)):void(t.access_token?(Object(i["c"])(t.access_token),e.$router.push({path:"/main"}),e.loading=!1):(c["Message"].error(t),e.loading=!1))})).catch((function(){e.loading=!1}))}else c["Message"].warning("邮箱验证码错误")}))})):c["Message"].error("两次输入的密码不一致"):c["Message"].error("请填写验证码"):c["Message"].error("请填写登录密码"):c["Message"].error("请填写用户名和邮箱")}}},l=p,d=(r("2017"),r("060f"),r("2877")),m=Object(d["a"])(l,s,a,!1,null,"899ede9a",null);t["default"]=m.exports},cafe:function(e,t,r){},d733:function(e,t,r){}}]);